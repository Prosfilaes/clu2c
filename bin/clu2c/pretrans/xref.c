/* Generated by clu2c (version 1.99.3) */
/* option, optimize time */
/* depend,xref,stream*/
/* param_mod_call,clop,PV1_INxref_Dadd__ref,xref$add_ref,xref,find_index,record[key:string users:array[string]]*/
/* built-in param,record$get_key,PV2_INxref_Dadd__ref,xref$add_ref,key:string users:array[string]*/
/* param_mod_call,clop,PV3_INxref_Dadd__ref,xref$add_ref,xref,find_index,string*/
/* param_mod_call,clop,PV1_INxref_Dadd__refs,xref$add_refs,xref,find_index,record[key:string users:array[string]]*/
/* built-in param,record$get_key,PV2_INxref_Dadd__refs,xref$add_refs,key:string users:array[string]*/
/* param_mod_call,clop,PV3_INxref_Dadd__refs,xref$add_refs,xref,find_index,string*/
/* param_mod_call,clop,PV1_INxref_Drem__refs,xref$rem_refs,xref,find_index,record[key:string users:array[string]]*/
/* built-in param,record$get_key,PV2_INxref_Drem__refs,xref$rem_refs,key:string users:array[string]*/
/* param_mod_decl,clus_op,4,xref,find_index*/

#include <clu2c.h>

extern object	PV1_INxref_Dadd__ref;
extern object	PV2_INxref_Dadd__ref;
extern object	PV3_INxref_Dadd__ref;
extern int	OFstring_Dcopy();
extern object	PV1_INxref_Dadd__refs;
extern object	PV2_INxref_Dadd__refs;
extern object	PV3_INxref_Dadd__refs;
extern object	PV1_INxref_Drem__refs;
extern object	PV2_INxref_Drem__refs;
extern int	OFxref_Dentry__maker();

static STRING_REP(10) str1 = {10, {'_', '_', '_', '_', '_', '_', '_', '_', '_', '_'}};
static STRING_REP(7) str2 = {7, {'u', 'n', 'k', 'n', 'o', 'w', 'n'}};

/* begin module */
/* c_function_name, OFxref_Dcreate */
/* clu_operation_name, xref$create */
int OFxref_Dcreate()
{
  /* begin body */
  OFarray_Dcreate(0);
  retval_area[0] = retval_area[0];
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Dadd__ref */
/* clu_operation_name, xref$add_ref */
int OFxref_Dadd__ref(LVtab, LVkey, LVuser)
     object LVtab;
     object LVkey;
     object LVuser;
{
  object LVmusers= 0;
  int t1, t2, t3;
  /* begin body */
  if ((*((proctype)PV1_INxref_Dadd__ref))(LVtab, LVkey, PV2_INxref_Dadd__ref, OFxref_Dentry__maker) == SIG)
    {
      goto except0;
    }
  if (OMarray_Dbounds(LVtab, retval_area[0]))
    {
      signame = SLBOUNDS;
      goto except0;
    }
  LVmusers = OMrecord_Dget(2, OMarray_Dfetch(LVtab, retval_area[0]));
    {
      object LVmuser= 0;
      for (t1 = LVmusers, t2 = OMarray_Dlow(t1), t3 = OMarray_Dhigh(t1);
           t2 <= t3;
           t2++)
        {
	  LVmuser = OMarray_Dfetch(t1, t2);
	    {
	      if (OMstring_Dequal(LVuser, LVmuser))
	        {
		  return RET;
	        }
	    }
        }
    }
  if ((*((proctype)PV3_INxref_Dadd__ref))(LVmusers, LVuser, OFstring_Dcopy, OFstring_Dcopy) == SIG)
    {
      goto except0;
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Dadd__refs */
/* clu_operation_name, xref$add_refs */
int OFxref_Dadd__refs(LVtab, LVkey, LVusers)
     object LVtab;
     object LVkey;
     object LVusers;
{
  object LVmusers= 0;
  int t1, t2, t3, t4, t5, t6;
  /* begin body */
  if ((*((proctype)PV1_INxref_Dadd__refs))(LVtab, LVkey, PV2_INxref_Dadd__refs, OFxref_Dentry__maker) == SIG)
    {
      goto except0;
    }
  if (OMarray_Dbounds(LVtab, retval_area[0]))
    {
      signame = SLBOUNDS;
      goto except0;
    }
  LVmusers = OMrecord_Dget(2, OMarray_Dfetch(LVtab, retval_area[0]));
    {
      object LVuser= 0;
      for (t1 = LVusers, t2 = OMarray_Dlow(t1), t3 = OMarray_Dhigh(t1);
           t2 <= t3;
           t2++)
        {
	  LVuser = OMarray_Dfetch(t1, t2);
	    {
	      object LVnew= 0;
	      LVnew = TRUE;
	        {
		  object LVmuser= 0;
		  for (t4 = LVmusers, t5 = OMarray_Dlow(t4), t6 = OMarray_Dhigh(t4);
		       t5 <= t6;
		       t5++)
		    {
		      LVmuser = OMarray_Dfetch(t4, t5);
		        {
			  if (OMstring_Dequal(LVuser, LVmuser))
			    {
			      LVnew = FALSE;
			      break;
			    }
		        }
		    }
	        }
	      if (LVnew)
	        {
		  if ((*((proctype)PV3_INxref_Dadd__refs))(LVmusers, LVuser, OFstring_Dcopy, OFstring_Dcopy) == SIG)
		    {
		      goto except0;
		    }
	        }
	    }
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Drem__refs */
/* clu_operation_name, xref$rem_refs */
int OFxref_Drem__refs(LVtab, LVkey)
     object LVtab;
     object LVkey;
{
  object LVi= 0;
  object LVusers= 0;
  object LVll= 0;
  object LVhh= 0;
  int t1, t2, t3, t4, t5;
  /* begin body */
  if ((*((proctype)PV1_INxref_Drem__refs))(LVtab, LVkey, PV2_INxref_Drem__refs, OFxref_Dentry__maker) == SIG)
    {
      goto except0;
    }
  LVi = retval_area[0];
  if (OMarray_Dbounds(LVtab, LVi))
    {
      signame = SLBOUNDS;
      goto except0;
    }
  LVusers = OMrecord_Dget(2, OMarray_Dfetch(LVtab, LVi));
  LVll = OMarray_Dlow(LVtab);
  LVhh = OMarray_Dhigh(LVtab);
  t1 = OMint_Dsub(LVi, LVll);
  if (OMint_Dgt(t1, OMint_Dsub(LVhh, LVi)))
    {
        {
	  object LVj= 0;
	  for (t2 = OMint_Dadd(LVi, 1), t3 = LVhh; t2 <= t3; t2++)
	    {
	      LVj = t2;
	        {
		  t4 = OMint_Dsub(LVj, 1);
		  if (OMarray_Dbounds(LVtab, LVj))
		    {
		      signame = SLBOUNDS;
		      goto except0;
		    }
		  t5 = OMarray_Dfetch(LVtab, LVj);
		  if (OMarray_Dbounds(LVtab, t4))
		    {
		      signame = SLBOUNDS;
		      goto except0;
		    }
		  OMarray_Dstore(LVtab, t4, t5);
	        }
	    }
        }
      if (OMarray_Dempty(LVtab))
        {
	  signame = SLBOUNDS;
	  goto except0;
        }
      OMarray_Dremh(LVtab);
    }
  else
    {
        {
	  object LVj= 0;
	  for (t2 = OMint_Dsub(LVi, 1), t3 = LVll; t2 >= t3; t2 -= 1)
	    {
	      LVj = t2;
	        {
		  t4 = OMint_Dadd(LVj, 1);
		  if (OMarray_Dbounds(LVtab, LVj))
		    {
		      signame = SLBOUNDS;
		      goto except0;
		    }
		  t5 = OMarray_Dfetch(LVtab, LVj);
		  if (OMarray_Dbounds(LVtab, t4))
		    {
		      signame = SLBOUNDS;
		      goto except0;
		    }
		  OMarray_Dstore(LVtab, t4, t5);
	        }
	    }
        }
      if (OMarray_Dempty(LVtab))
        {
	  signame = SLBOUNDS;
	  goto except0;
        }
      OMarray_Dreml(LVtab);
    }
  retval_area[0] = LVusers;
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Dentry__maker */
/* clu_operation_name, xref$entry_maker */
int OFxref_Dentry__maker(LVkey)
     object LVkey;
{
  int t1;
  /* begin body */
  OFarray_Dcreate(0);
  t1 = OFrecord_D__alloc(2);
  OMrecord_Dset(1, t1, LVkey);
  OMrecord_Dset(2, t1, retval_area[0]);
  retval_area[0] = t1;
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Dfind__index */
/* clu_operation_name, xref$find_index */
int OFxref_Dfind__index(pi, LVtab, LVkey, LVget, LVcons)
     param_info *pi;
     object LVtab;
     object LVkey;
     object LVget;
     object LVcons;
{
  object LVll= 0;
  object LVhh= 0;
  object LVl= 0;
  object LVh= 0;
  object LVent= 0;
  int t1, t2, t3, t4, t5;
  /* begin body */
  LVll = OMarray_Dlow(LVtab);
  LVhh = OMarray_Dhigh(LVtab);
  LVl = LVll;
  LVh = LVhh;
  while (TRUE)
    {
      if (!OMint_Dle(LVl, LVh))
        {
	  break;
        }
        {
	  object LVm= 0;
	  object LVme= 0;
	  object LVmkey= 0;
	  t1 = OMint_Dadd(LVl, LVh);
	  if (OMint_Dzero__divide(2))
	    {
	      signame = SLZERO_DIVIDE;
	      goto except0;
	    }
	  LVm = OMint_Ddiv(t1, 2);
	  if (OMarray_Dbounds(LVtab, LVm))
	    {
	      signame = SLBOUNDS;
	      goto except0;
	    }
	  LVme = OMarray_Dfetch(LVtab, LVm);
	  if ((*((proctype)LVget))(LVme) == SIG)
	    {
	      goto except0;
	    }
	  LVmkey = retval_area[0];
	  if (OMstring_Dlt(LVkey, LVmkey))
	    {
	      LVh = OMint_Dsub(LVm, 1);
	    }
	  else
	    {
	      if (OMstring_Dequal(LVkey, LVmkey))
	        {
		  retval_area[0] = LVm;
		  return RET;
	        }
	      else
	        {
		  LVl = OMint_Dadd(LVm, 1);
	        }
	    }
        }
    }
  if ((*((proctype)LVcons))(LVkey) == SIG)
    {
      goto except0;
    }
  LVent = retval_area[0];
  t1 = OMint_Dsub(LVhh, LVl);
  if (OMint_Dle(t1, OMint_Dsub(LVh, LVll)))
    {
      OMarray_Daddh(LVtab, LVent);
        {
	  object LVn= 0;
	  for (t2 = LVhh, t3 = LVl; t2 >= t3; t2 -= 1)
	    {
	      LVn = t2;
	        {
		  t4 = OMint_Dadd(LVn, 1);
		  if (OMarray_Dbounds(LVtab, LVn))
		    {
		      signame = SLBOUNDS;
		      goto except0;
		    }
		  t5 = OMarray_Dfetch(LVtab, LVn);
		  if (OMarray_Dbounds(LVtab, t4))
		    {
		      signame = SLBOUNDS;
		      goto except0;
		    }
		  OMarray_Dstore(LVtab, t4, t5);
	        }
	    }
        }
      if (OMarray_Dbounds(LVtab, LVl))
        {
	  signame = SLBOUNDS;
	  goto except0;
        }
      OMarray_Dstore(LVtab, LVl, LVent);
      retval_area[0] = LVl;
      return RET;
    }
  else
    {
      OMarray_Daddl(LVtab, LVent);
        {
	  object LVn= 0;
	  for (t2 = LVll, t3 = LVh; t2 <= t3; t2 += 1)
	    {
	      LVn = t2;
	        {
		  t4 = OMint_Dsub(LVn, 1);
		  if (OMarray_Dbounds(LVtab, LVn))
		    {
		      signame = SLBOUNDS;
		      goto except0;
		    }
		  t5 = OMarray_Dfetch(LVtab, LVn);
		  if (OMarray_Dbounds(LVtab, t4))
		    {
		      signame = SLBOUNDS;
		      goto except0;
		    }
		  OMarray_Dstore(LVtab, t4, t5);
	        }
	    }
        }
      if (OMarray_Dbounds(LVtab, LVh))
        {
	  signame = SLBOUNDS;
	  goto except0;
        }
      OMarray_Dstore(LVtab, LVh, LVent);
      retval_area[0] = LVh;
      return RET;
    }
  /* end body */
  noretval(SLNULL);
  return(SIG);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Delements */
/* clu_operation_name, xref$elements */
#define INV_TOP 5
#define WORK_SIZE 13
int OFxref_Delements(init, ivarp, LVtab)
     bool init;
     int **ivarp;
     object LVtab;
{
  if (init)
    {
      *ivarp = (int*) malloc(WORK_SIZE*sizeof(int));
      (*ivarp)[1] = LVtab;
    }
  else
    {
      switch ((*ivarp)[0])
  	{
  	  case 1: goto yield1;
  	}
    }
  /* begin body */
    {
      for ((*ivarp)[INV_TOP+0] = (*ivarp)[1], (*ivarp)[INV_TOP+1] = OMarray_Dlow((*ivarp)[INV_TOP+0]), (*ivarp)[INV_TOP+2] = OMarray_Dhigh((*ivarp)[INV_TOP+0]);
           (*ivarp)[INV_TOP+1] <= (*ivarp)[INV_TOP+2];
           (*ivarp)[INV_TOP+1]++)
        {
	  (*ivarp)[2] = OMarray_Dfetch((*ivarp)[INV_TOP+0], (*ivarp)[INV_TOP+1]);
	    {
	      (*ivarp)[3] = OMrecord_Dget(1, (*ivarp)[2]);
	        {
		  for ((*ivarp)[INV_TOP+3] = OMrecord_Dget(2, (*ivarp)[2]), (*ivarp)[INV_TOP+4] = OMarray_Dlow((*ivarp)[INV_TOP+3]), (*ivarp)[INV_TOP+5] = OMarray_Dhigh((*ivarp)[INV_TOP+3]);
		       (*ivarp)[INV_TOP+4] <= (*ivarp)[INV_TOP+5];
		       (*ivarp)[INV_TOP+4]++)
		    {
		      (*ivarp)[4] = OMarray_Dfetch((*ivarp)[INV_TOP+3], (*ivarp)[INV_TOP+4]);
		        {
			  (*ivarp)[INV_TOP+6] = (*ivarp)[3];
			  (*ivarp)[INV_TOP+7] = (*ivarp)[4];
			  retval_area[0] = (*ivarp)[INV_TOP+6];
			  retval_area[1] = (*ivarp)[INV_TOP+7];
			  (*ivarp)[0] = 1;
			  return YIELD;
			yield1:
			  NO_OPERATION;
		        }
		    }
	        }
	    }
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
#undef INV_TOP
#undef WORK_SIZE
/* c_function_name, OFxref_Dkeys */
/* clu_operation_name, xref$keys */
#define INV_TOP 3
#define WORK_SIZE 6
int OFxref_Dkeys(init, ivarp, LVtab)
     bool init;
     int **ivarp;
     object LVtab;
{
  if (init)
    {
      *ivarp = (int*) malloc(WORK_SIZE*sizeof(int));
      (*ivarp)[1] = LVtab;
    }
  else
    {
      switch ((*ivarp)[0])
  	{
  	  case 1: goto yield1;
  	}
    }
  /* begin body */
    {
      for ((*ivarp)[INV_TOP+0] = (*ivarp)[1], (*ivarp)[INV_TOP+1] = OMarray_Dlow((*ivarp)[INV_TOP+0]), (*ivarp)[INV_TOP+2] = OMarray_Dhigh((*ivarp)[INV_TOP+0]);
           (*ivarp)[INV_TOP+1] <= (*ivarp)[INV_TOP+2];
           (*ivarp)[INV_TOP+1]++)
        {
	  (*ivarp)[2] = OMarray_Dfetch((*ivarp)[INV_TOP+0], (*ivarp)[INV_TOP+1]);
	    {
	      retval_area[0] = OMrecord_Dget(1, (*ivarp)[2]);
	      (*ivarp)[0] = 1;
	      return YIELD;
	    yield1:
	      NO_OPERATION;
	    }
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
#undef INV_TOP
#undef WORK_SIZE
/* c_function_name, OFxref_Doutput */
/* clu_operation_name, xref$output */
int OFxref_Doutput(LVtab, LVlhead, LVrhead, LVst)
     object LVtab;
     object LVlhead;
     object LVrhead;
     object LVst;
{
  object LVmax= 0;
  int t1, t2, t3, t4;
  /* begin body */
  if (OMint_Dequal(OMarray_Dsize(LVtab), 0))
    {
      return RET;
    }
  LVmax = OMstring_Dsize(LVlhead);
    {
      object LVent= 0;
      for (t1 = LVtab, t2 = OMarray_Dlow(t1), t3 = OMarray_Dhigh(t1);
           t2 <= t3;
           t2++)
        {
	  LVent = OMarray_Dfetch(t1, t2);
	    {
	      object LVn= 0;
	      LVn = OMstring_Dsize(OMrecord_Dget(1, LVent));
	      if (OMint_Dgt(LVn, LVmax))
	        {
		  LVmax = LVn;
	        }
	    }
        }
    }
  LVmax = OMint_Dadd(LVmax, 4);
    {
      t1 = OFarray_D__alloc(1, 1);
      OMarray_Dstore(t1, 1, LVrhead);
      if (OFxref_Dputout(LVst, LVlhead, t1, LVmax) == SIG)
        {
	  goto except1;
        }
        {
	  object LVi= 0;
	  for (t1 = 1; t1 <= 7; t1++)
	    {
	      LVi = t1;
	        {
		  if (OFstream_Dputs(LVst, ((string) &str1)) == SIG)
		    {
		      goto except1;
		    }
	        }
	    }
        }
      if (OFstream_Dputc(LVst, '\n') == SIG)
        {
	  goto except1;
        }
        {
	  object LVent= 0;
	  for (t1 = LVtab, t2 = OMarray_Dlow(t1), t3 = OMarray_Dhigh(t1);
	       t2 <= t3;
	       t2++)
	    {
	      LVent = OMarray_Dfetch(t1, t2);
	        {
		  t4 = OMrecord_Dget(1, LVent);
		  if (OFxref_Dputout(LVst, t4, OMrecord_Dget(2, LVent), LVmax) == SIG)
		    {
		      goto except1;
		    }
	        }
	    }
        }
    }
  if (FALSE)
    {
    except1:
      if (OMstring_Dequal(signame, SLNOT_POSSIBLE))
        {
	  return(SIG);
        }
      else
        {
	  goto except0;
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Dputout */
/* clu_operation_name, xref$putout */
int OFxref_Dputout(LVst, LVkey, LVusers, LVmax)
     object LVst;
     object LVkey;
     object LVusers;
     object LVmax;
{
  int t1, t2, t3;
  /* begin body */
    {
      object LVpos= 0;
      if (OFstream_Dputleft(LVst, LVkey, LVmax) == SIG)
        {
	  goto except1;
        }
      LVpos = LVmax;
        {
	  object LVuser= 0;
	  for (t1 = LVusers, t2 = OMarray_Dlow(t1), t3 = OMarray_Dhigh(t1);
	       t2 <= t3;
	       t2++)
	    {
	      LVuser = OMarray_Dfetch(t1, t2);
	        {
		  object LVn= 0;
		  LVn = OMint_Dadd(OMstring_Dsize(LVuser), 1);
		  if (OMint_Dgt(OMint_Dadd(LVpos, LVn), 70))
		    {
		      if (OFstream_Dputc(LVst, '\n') == SIG)
		        {
			  goto except1;
		        }
		      if (OFstream_Dputspace(LVst, LVmax) == SIG)
		        {
			  goto except1;
		        }
		      LVpos = LVmax;
		    }
		  if (OFstream_Dputc(LVst, ' ') == SIG)
		    {
		      goto except1;
		    }
		  if (OFstream_Dputs(LVst, LVuser) == SIG)
		    {
		      goto except1;
		    }
		  LVpos = OMint_Dadd(LVpos, LVn);
	        }
	    }
        }
      if (OFstream_Dputc(LVst, '\n') == SIG)
        {
	  goto except1;
        }
    }
  if (FALSE)
    {
    except1:
      if (OMstring_Dequal(signame, SLNOT_POSSIBLE))
        {
	  return(SIG);
        }
      else
        {
	  goto except0;
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Dmerge */
/* clu_operation_name, xref$merge */
int OFxref_Dmerge(LVtab1, LVtab2)
     object LVtab1;
     object LVtab2;
{
  int t1, t2;
  /* begin body */
    {
      object LVkey= 0;
      object LVuser= 0;
      for (t1 = OFxref_Delements(TRUE, &t2, LVtab2);
           t1 == YIELD;
           t1 = OFxref_Delements(FALSE, &t2, 0))
        {
	  LVkey = retval_area[0];
	  LVuser = retval_area[1];
	    {
	      if (OFxref_Dadd__ref(LVtab1, LVkey, LVuser) == SIG)
	        {
		  goto except0;
	        }
	    }
        }
      free(t2);
      if (t1 == SIG)
        {
	  goto except0;
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Dflush */
/* clu_operation_name, xref$flush */
int OFxref_Dflush(LVtab)
     object LVtab;
{
  /* begin body */
  OMarray_Dset__low(LVtab, 1);
  if (OFarray_Dtrim(LVtab, 1, 0) == SIG)
    {
      goto except0;
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFxref_Dget__refs */
/* clu_operation_name, xref$get_refs */
#define INV_TOP 5
#define WORK_SIZE 8
int OFxref_Dget__refs(init, ivarp, LVtab, LVkey)
     bool init;
     int **ivarp;
     object LVtab;
     object LVkey;
{
  if (init)
    {
      *ivarp = (int*) malloc(WORK_SIZE*sizeof(int));
      (*ivarp)[1] = LVtab;
      (*ivarp)[2] = LVkey;
    }
  else
    {
      switch ((*ivarp)[0])
  	{
  	  case 1: goto yield1;
  	}
    }
  /* begin body */
  if (OFxref_Drem__refs((*ivarp)[1], (*ivarp)[2]) == SIG)
    {
      goto except0;
    }
  (*ivarp)[3] = retval_area[0];
  if (OFxref_Dadd__refs((*ivarp)[1], (*ivarp)[2], (*ivarp)[3]) == SIG)
    {
      goto except0;
    }
    {
      for ((*ivarp)[INV_TOP+0] = (*ivarp)[3], (*ivarp)[INV_TOP+1] = OMarray_Dlow((*ivarp)[INV_TOP+0]), (*ivarp)[INV_TOP+2] = OMarray_Dhigh((*ivarp)[INV_TOP+0]);
           (*ivarp)[INV_TOP+1] <= (*ivarp)[INV_TOP+2];
           (*ivarp)[INV_TOP+1]++)
        {
	  (*ivarp)[4] = OMarray_Dfetch((*ivarp)[INV_TOP+0], (*ivarp)[INV_TOP+1]);
	    {
	      retval_area[0] = (*ivarp)[4];
	      (*ivarp)[0] = 1;
	      return YIELD;
	    yield1:
	      NO_OPERATION;
	    }
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
#undef INV_TOP
#undef WORK_SIZE
/* c_function_name, OFxref_Dpeek__refs */
/* clu_operation_name, xref$peek_refs */
#define INV_TOP 8
#define WORK_SIZE 11
int OFxref_Dpeek__refs(init, ivarp, LVtab, LVkey)
     bool init;
     int **ivarp;
     object LVtab;
     object LVkey;
{
  if (init)
    {
      *ivarp = (int*) malloc(WORK_SIZE*sizeof(int));
      (*ivarp)[1] = LVtab;
      (*ivarp)[2] = LVkey;
    }
  else
    {
      switch ((*ivarp)[0])
  	{
  	  case 1: goto yield1;
  	}
    }
  /* begin body */
  (*ivarp)[3] = OMarray_Dlow((*ivarp)[1]);
  (*ivarp)[4] = OMarray_Dhigh((*ivarp)[1]);
  (*ivarp)[6] = FALSE;
  while (TRUE)
    {
      if (!OMint_Dle((*ivarp)[3], (*ivarp)[4]))
        {
	  break;
        }
        {
	  (*ivarp)[INV_TOP+0] = OMint_Dadd((*ivarp)[3], (*ivarp)[4]);
	  if (OMint_Dzero__divide(2))
	    {
	      signame = SLZERO_DIVIDE;
	      goto except0;
	    }
	  (*ivarp)[5] = OMint_Ddiv((*ivarp)[INV_TOP+0], 2);
	  if (OMarray_Dbounds((*ivarp)[1], (*ivarp)[5]))
	    {
	      signame = SLBOUNDS;
	      goto except0;
	    }
	  (*ivarp)[7] = OMrecord_Dget(1, OMarray_Dfetch((*ivarp)[1], (*ivarp)[5]));
	  if (OMstring_Dequal((*ivarp)[7], (*ivarp)[2]))
	    {
	      (*ivarp)[6] = TRUE;
	      break;
	    }
	  else
	    {
	      if (OMstring_Dlt((*ivarp)[7], (*ivarp)[2]))
	        {
		  (*ivarp)[3] = OMint_Dadd((*ivarp)[5], 1);
	        }
	      else
	        {
		  (*ivarp)[4] = OMint_Dsub((*ivarp)[5], 1);
	        }
	    }
        }
    }
  if (OMbool_Dnot((*ivarp)[6]))
    {
      signame = ((string) &str2);
      return(SIG);
    }
    {
      if (OMarray_Dbounds((*ivarp)[1], (*ivarp)[5]))
        {
	  signame = SLBOUNDS;
	  goto except0;
        }
      for ((*ivarp)[INV_TOP+0] = OMrecord_Dget(2, OMarray_Dfetch((*ivarp)[1], (*ivarp)[5])), (*ivarp)[INV_TOP+1] = OMarray_Dlow((*ivarp)[INV_TOP+0]), (*ivarp)[INV_TOP+2] = OMarray_Dhigh((*ivarp)[INV_TOP+0]);
           (*ivarp)[INV_TOP+1] <= (*ivarp)[INV_TOP+2];
           (*ivarp)[INV_TOP+1]++)
        {
	  (*ivarp)[7] = OMarray_Dfetch((*ivarp)[INV_TOP+0], (*ivarp)[INV_TOP+1]);
	    {
	      retval_area[0] = (*ivarp)[7];
	      (*ivarp)[0] = 1;
	      return YIELD;
	    yield1:
	      NO_OPERATION;
	    }
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
#undef INV_TOP
#undef WORK_SIZE
/* c_function_name, OFxref_Dexists */
/* clu_operation_name, xref$exists */
int OFxref_Dexists(LVtab, LVkey)
     object LVtab;
     object LVkey;
{
  int t1, t2;
  /* begin body */
    {
      object LVs= 0;
      for (t1 = OFxref_Dkeys(TRUE, &t2, LVtab);
           t1 == YIELD;
           t1 = OFxref_Dkeys(FALSE, &t2, 0))
        {
	  LVs = retval_area[0];
	    {
	      if (OMstring_Dequal(LVkey, LVs))
	        {
		  retval_area[0] = TRUE;
		  return RET;
	        }
	    }
        }
      free(t2);
      if (t1 == SIG)
        {
	  goto except0;
        }
    }
  retval_area[0] = FALSE;
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* end module */
