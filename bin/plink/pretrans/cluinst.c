/* Generated by clu2c (version 1.99.3) */
/* option, optimize time */
/* depend,cluinst,appgen,appinst,assoc_array,clugen,db_env,formal_parmlist,parmlist_unparse,stream,type_id*/
/* param_mod_call,clop,PV1_INcluinst_Dcreate,cluinst$create,assoc_array[array[appinst]],new,no_param*/
/* param_mod_call,clop,PV1_INcluinst_Dlookup__op,cluinst$lookup_op,assoc_array[array[appinst]],lookup,no_param*/
/* built-in param,array$similar,PV2_INcluinst_Dlookup__op,cluinst$lookup_op,oneof[tparm:oneof[clu:cluinst fparm:int sel:selinst] vparm:oneof[fparm:int lit:string]]*/
/* param_mod_call,clop,PV1_INcluinst_Denter__op,cluinst$enter_op,assoc_array[array[appinst]],lookup,no_param*/
/* param_mod_call,clop,PV2_INcluinst_Denter__op,cluinst$enter_op,assoc_array[array[appinst]],enter,no_param*/

#include <clu2c.h>

extern object	PV1_INcluinst_Denter__op;
extern object	PV2_INcluinst_Denter__op;
extern object	PV1_INcluinst_Dlookup__op;
extern object	PV2_INcluinst_Dlookup__op;
extern object	PV1_INcluinst_Dcreate;

static STRING_REP(6) str1 = {6, {'e', 'x', 'i', 's', 't', 's'}};
static STRING_REP(4) str2 = {4, {'i', 'n', 't', ' '}};
static STRING_REP(3) str3 = {3, {' ', '=', ' '}};
static STRING_REP(2) str4 = {2, {';', '\t'}};
static STRING_REP(1) str5 = {1, {';'}};

/* begin module */
/* c_function_name, OFcluinst_Dcreate */
/* clu_operation_name, cluinst$create */
int OFcluinst_Dcreate(LVgen, LVparms)
     object LVgen;
     object LVparms;
{
  object LVinst= 0;
  int t1, t2;
  /* begin body */
  if (OFclugen_Dlookup__inst(LVgen, LVparms) == SIG)
    {
      goto except1;
    }
  retval_area[0] = retval_area[0];
  return RET;
  if (FALSE)
    {
    except1:
      if (OMstring_Dequal(signame, SLNOT_FOUND))
        {
        }
      else
        {
	  goto except0;
        }
    }
  if ((*((proctype)PV1_INcluinst_Dcreate))() == SIG)
    {
      goto except0;
    }
  t1 = retval_area[0];
  OFarray_Dnew();
  t2 = OFrecord_D__alloc(7);
  OMrecord_Dset(1, t2, LVgen);
  OMrecord_Dset(2, t2, -1);
  OMrecord_Dset(3, t2, t1);
  OMrecord_Dset(4, t2, LVparms);
  OMrecord_Dset(5, t2, FALSE);
  OMrecord_Dset(6, t2, retval_area[0]);
  OMrecord_Dset(7, t2, -1);
  LVinst = t2;
  if (AFformal__parmlist(LVparms) == SIG)
    {
      goto except0;
    }
  if (OMbool_Dnot(retval_area[0]))
    {
      if (OFclugen_Denter__inst(LVgen, LVinst) == SIG)
        {
	  goto except0;
        }
      OMrecord_Dset(2, LVinst, retval_area[0]);
    }
  retval_area[0] = LVinst;
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Dget__gen */
/* clu_operation_name, cluinst$get_gen */
int OFcluinst_Dget__gen(LVinst)
     object LVinst;
{
  /* begin body */
  retval_area[0] = OMrecord_Dget(1, LVinst);
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Dget__parms */
/* clu_operation_name, cluinst$get_parms */
int OFcluinst_Dget__parms(LVinst)
     object LVinst;
{
  /* begin body */
  retval_area[0] = OMrecord_Dget(4, LVinst);
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Dlookup__op */
/* clu_operation_name, cluinst$lookup_op */
int OFcluinst_Dlookup__op(LVinst, LVname, LVparms)
     object LVinst;
     object LVname;
     object LVparms;
{
  int t1, t2, t3;
  /* begin body */
    {
      object LVop= 0;
      if ((*((proctype)PV1_INcluinst_Dlookup__op))(OMrecord_Dget(3, LVinst), LVname) == SIG)
        {
	  goto except1;
        }
      for (t1 = retval_area[0], t2 = OMarray_Dlow(t1), t3 = OMarray_Dhigh(t1);
           t2 <= t3;
           t2++)
        {
	  LVop = OMarray_Dfetch(t1, t2);
	    {
	      if (OFappinst_Dget__parms(LVop) == SIG)
	        {
		  goto except1;
	        }
	      if ((*((proctype)PV2_INcluinst_Dlookup__op))(retval_area[0], LVparms) == SIG)
	        {
		  goto except1;
	        }
	      if (retval_area[0])
	        {
		  retval_area[0] = LVop;
		  return RET;
	        }
	    }
        }
    }
  if (FALSE)
    {
    except1:
      if (OMstring_Dequal(signame, SLNOT_FOUND))
        {
	  return(SIG);
        }
      else
        {
	  goto except0;
        }
    }
  signame = SLNOT_FOUND;
  return(SIG);
  /* end body */
  noretval(SLNULL);
  return(SIG);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Denter__op */
/* clu_operation_name, cluinst$enter_op */
int OFcluinst_Denter__op(LVinst, LVop)
     object LVinst;
     object LVop;
{
  object LVname= 0;
  object LVparms= 0;
  object LVops= 0;
  object LVid= 0;
  int t1;
  /* begin body */
  if (OFappinst_Dget__gen(LVop) == SIG)
    {
      goto except0;
    }
  if (OFappgen_Dget__name(retval_area[0]) == SIG)
    {
      goto except0;
    }
  LVname = retval_area[0];
  if (OFappinst_Dget__parms(LVop) == SIG)
    {
      goto except0;
    }
  LVparms = retval_area[0];
    {
      if (OFcluinst_Dlookup__op(LVinst, LVname, LVparms) == SIG)
        {
	  goto except1;
        }
      signame = ((string) &str1);
      return(SIG);
    }
  if (FALSE)
    {
    except1:
      if (OMstring_Dequal(signame, SLNOT_FOUND))
        {
        }
      else
        {
	  goto except0;
        }
    }
  if ((*((proctype)PV1_INcluinst_Denter__op))(OMrecord_Dget(3, LVinst), LVname) == SIG)
    {
      goto except2;
    }
  LVops = retval_area[0];
  if (FALSE)
    {
    except2:
      if (OMstring_Dequal(signame, SLNOT_FOUND))
        {
	  OFarray_Dnew();
	  LVops = retval_area[0];
	  if ((*((proctype)PV2_INcluinst_Denter__op))(OMrecord_Dget(3, LVinst), LVname, LVops) == SIG)
	    {
	      goto except0;
	    }
        }
      else
        {
	  goto except0;
        }
    }
  t1 = FALSE;
  if (AFformal__parmlist(OMrecord_Dget(4, LVinst)) == SIG)
    {
      goto except0;
    }
  if (OMbool_Dnot(retval_area[0]))
    {
      if (OFappinst_Dget__parms(LVop) == SIG)
        {
	  goto except0;
        }
      if (AFformal__parmlist(retval_area[0]) == SIG)
        {
	  goto except0;
        }
      if (OMbool_Dnot(retval_area[0]))
        {
	  t1 = TRUE;
        }
    }
  if (t1)
    {
      if (OFappinst_Dget__gen(LVop) == SIG)
        {
	  goto except0;
        }
      if (OFappgen_Denter__inst(retval_area[0], LVop) == SIG)
        {
	  goto except0;
        }
      LVid = retval_area[0];
    }
  else
    {
      LVid = -1;
    }
  OMarray_Daddh(LVops, LVop);
  retval_area[0] = LVid;
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Dget__id */
/* clu_operation_name, cluinst$get_id */
int OFcluinst_Dget__id(LVinst)
     object LVinst;
{
  /* begin body */
  retval_area[0] = OMrecord_Dget(2, LVinst);
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Dadd__tidvar */
/* clu_operation_name, cluinst$add_tidvar */
int OFcluinst_Dadd__tidvar(LVinst, LVvar)
     object LVinst;
     object LVvar;
{
  /* begin body */
  OMarray_Daddh(OMrecord_Dget(6, LVinst), LVvar);
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Demit__types */
/* clu_operation_name, cluinst$emit_types */
int OFcluinst_Demit__types(LVinst, LVoutst)
     object LVinst;
     object LVoutst;
{
  object LVtid= 0;
  object LVdb= 0;
  int t1, t2, t3;
  /* begin body */
  OFoneof_Dmake(1, LVinst);
  if (AFtype__id(retval_area[0]) == SIG)
    {
      goto except0;
    }
  OFint_Dunparse(retval_area[0]);
  LVtid = retval_area[0];
  if (OFdb__env_Dget() == SIG)
    {
      goto except0;
    }
  LVdb = retval_area[0];
  if (OFdb__env_Dget__debug(LVdb) == SIG)
    {
      goto except0;
    }
  if (retval_area[0])
    {
        {
	  object LVvar= 0;
	  for (t1 = OMrecord_Dget(6, LVinst), t2 = OMarray_Dlow(t1), t3 = OMarray_Dhigh(t1);
	       t2 <= t3;
	       t2++)
	    {
	      LVvar = OMarray_Dfetch(t1, t2);
	        {
		  if (OFstream_Dputs(LVoutst, ((string) &str2)) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputs(LVoutst, LVvar) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputs(LVoutst, ((string) &str3)) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputs(LVoutst, LVtid) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputs(LVoutst, ((string) &str4)) == SIG)
		    {
		      goto except0;
		    }
		  if (OFdb__env_Dtid__info(LVdb, LVvar, LVtid) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputl(LVoutst, retval_area[0]) == SIG)
		    {
		      goto except0;
		    }
	        }
	    }
        }
    }
  else
    {
        {
	  object LVvar= 0;
	  for (t1 = OMrecord_Dget(6, LVinst), t2 = OMarray_Dlow(t1), t3 = OMarray_Dhigh(t1);
	       t2 <= t3;
	       t2++)
	    {
	      LVvar = OMarray_Dfetch(t1, t2);
	        {
		  if (OFstream_Dputs(LVoutst, ((string) &str2)) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputs(LVoutst, LVvar) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputs(LVoutst, ((string) &str3)) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputs(LVoutst, LVtid) == SIG)
		    {
		      goto except0;
		    }
		  if (OFstream_Dputl(LVoutst, ((string) &str5)) == SIG)
		    {
		      goto except0;
		    }
	        }
	    }
        }
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Dsimilar */
/* clu_operation_name, cluinst$similar */
int OFcluinst_Dsimilar(LVinst1, LVinst2)
     object LVinst1;
     object LVinst2;
{
  /* begin body */
  OFrecord_Dequal(LVinst1, LVinst2);
  retval_area[0] = retval_area[0];
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Denter__typeid */
/* clu_operation_name, cluinst$enter_typeid */
int OFcluinst_Denter__typeid(LVinst)
     object LVinst;
{
  /* begin body */
  if (OFdb__env_Dnewid() == SIG)
    {
      goto except0;
    }
  OMrecord_Dset(7, LVinst, retval_area[0]);
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Dget__typeid */
/* clu_operation_name, cluinst$get_typeid */
int OFcluinst_Dget__typeid(LVinst)
     object LVinst;
{
  /* begin body */
  retval_area[0] = OMrecord_Dget(7, LVinst);
  return RET;
  /* end body */
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* c_function_name, OFcluinst_Demit__typeid */
/* clu_operation_name, cluinst$emit_typeid */
int OFcluinst_Demit__typeid(LVinst, LVoutst)
     object LVinst;
     object LVoutst;
{
  object LVdb= 0;
  int t1, t2;
  /* begin body */
  if (OFdb__env_Dget() == SIG)
    {
      goto except0;
    }
  LVdb = retval_area[0];
  t1 = OMrecord_Dget(7, LVinst);
  if (OFclugen_Dget__name(OMrecord_Dget(1, LVinst)) == SIG)
    {
      goto except0;
    }
  t2 = retval_area[0];
  if (AFparmlist__unparse(OMrecord_Dget(4, LVinst)) == SIG)
    {
      goto except0;
    }
  if (OFdb__env_Dtype__info(LVdb, LVoutst, t1, t2, retval_area[0]) == SIG)
    {
      goto except0;
    }
  /* end body */
  return(RET);
except0:
  out_handler(SLNULL);
  return(SIG);
}
/* end module */
